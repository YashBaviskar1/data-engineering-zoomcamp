id: 05_taxi_scheduler_yellow_2020
namespace: zoomcamp
description: |
  Orchestrate the ingestion of Yellow Taxi data for all months of 2020.

tasks:
  - id: iterate_months
    type: io.kestra.plugin.core.flow.ForEach
    # List all months you want to process
    values: ["01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12"]
    
    tasks:
      - id: run_ingestion_flow
        type: io.kestra.plugin.core.flow.Subflow
        flowId: 04_postgres_taxi  # This must match the ID of your original flow
        namespace: zoomcamp       # This must match the namespace of your original flow
        
        # Pass the specific inputs to the child flow
        inputs:
          taxi: "yellow"
          year: "2020"
          month: "{{ taskrun.value }}"
        
        wait: true
